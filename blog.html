<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blog - jacob andr√©s</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

</head>
<body>
  <header id="header"></header>

  <main class="blog-layout">
    <aside id="sidebar">
      <input type="text" id="search" placeholder="Search blogs...">
      <ul id="blog-list"></ul>
    </aside>
    <article id="blog-content">Select a post to read.</article>
  </main>

  <script src="main.js"></script>
  <script>
    // GitHub blog rendering
    const repo = "jac0bandres/blog";
    const branch = "main";
    const folder = "posts";
    let allFiles = [];

    async function loadBlogList() {
      const res = await fetch(`https://api.github.com/repos/${repo}/contents/${folder}?ref=${branch}`);
      const files = await res.json();
      allFiles = files.filter(f => f.name.endsWith(".md"));
      renderBlogList(allFiles);
      if (allFiles.length > 0) loadBlog(allFiles[0].name);
    }

    function renderBlogList(files) {
      const listEl = document.getElementById("blog-list");
      listEl.innerHTML = "";
      files.forEach(file => {
        const li = document.createElement("li");
        const a = document.createElement("a");
        a.textContent = file.name.replace(".md", "");
        a.href = "#";
        a.className = "blog-link";
        a.onclick = (e) => {
          e.preventDefault();
          loadBlog(file.name);
        };
        li.appendChild(a);
        listEl.appendChild(li);
      });
    }

    async function loadBlog(file) {
      const url = `https://raw.githubusercontent.com/${repo}/${branch}/${folder}/${file}`;
      const res = await fetch(url);
      const md = await res.text();
      document.getElementById("blog-content").innerHTML = marked.parse(md);
    }

    document.getElementById("search").addEventListener("input", (e) => {
      const term = e.target.value.toLowerCase();
      const filtered = allFiles.filter(f => f.name.toLowerCase().includes(term));
      renderBlogList(filtered);
    });

    loadBlogList();
  </script>
  <script src="footer.js"></script>
</body>
</html>
